<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DropVault Files</title>
<style>
body { background: #121212; color: #eee; font-family: sans-serif; padding: 20px; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { padding: 10px; border-bottom: 1px solid #333; text-align: left; }
button { padding: 6px 12px; border-radius: 5px; border: none; background: #4cafef; color: #121212; cursor: pointer; }
button:hover { background: #2196f3; }
</style>
</head>
<body>

<h2>Available Files</h2>
<table id="filesTable">
<tr><th>Filename</th><th>Uploader</th><th>Access</th></tr>
<!-- JS will populate rows -->
</table>

<script>
const metadata = []; // You can fetch from server if needed

// Example: dynamically populate table if you send metadata from server
// Add Access button for password prompt
function createRow(file) {
  const tr = document.createElement('tr');
  tr.innerHTML = `<td>${file.filename}</td><td>${file.username}</td>
  <td><button onclick="accessFile('${file.filename}')">Access</button></td>`;
  document.getElementById('filesTable').appendChild(tr);
}

async function accessFile(filename){
  const password = prompt("Enter file password:");
  if(!password) return;
  const res = await fetch('/access-file', {
    method: 'POST',
    headers: { 'Content-Type':'application/json' },
    body: JSON.stringify({ filename, password })
  });
  const data = await res.json();
  if(data.error) alert(data.error);
  else window.open(data.url, '_blank');
}
</script>

</body>
</html>
